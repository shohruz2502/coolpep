<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coolpep - –ê–Ω–æ–Ω–∏–º–Ω—ã–π —á–∞—Ç</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: white;
        }
        
        /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —á–∞—Ç–∞ */
        .chat-header {
            background: rgba(26, 26, 46, 0.95);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 2px 20px rgba(0,0,0,0.3);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .back-button {
            background: rgba(255,255,255,0.1);
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }
        
        .back-button:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .anonymous-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 600;
            letter-spacing: 1px;
        }
        
        .chat-info {
            flex: 1;
            text-align: center;
        }
        
        .chat-title {
            font-weight: 600;
            font-size: 18px;
            margin-bottom: 3px;
        }
        
        .chat-subtitle {
            font-size: 12px;
            color: rgba(255,255,255,0.7);
        }
        
        .header-actions {
            display: flex;
            gap: 10px;
        }
        
        .header-action {
            font-size: 20px;
            color: white;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
            background: rgba(255,255,255,0.1);
        }
        
        .header-action:hover {
            background: rgba(255,255,255,0.2);
        }
        
        /* –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–± –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç–∏ */
        .warning-banner {
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid rgba(255, 107, 107, 0.3);
            margin: 15px;
            padding: 15px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .warning-icon {
            font-size: 24px;
            flex-shrink: 0;
        }
        
        .warning-text {
            font-size: 13px;
            color: rgba(255,255,255,0.9);
            line-height: 1.5;
        }
        
        /* –û–±–ª–∞—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π */
        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .message-date {
            text-align: center;
            color: rgba(255,255,255,0.5);
            font-size: 12px;
            margin: 10px 0;
            position: relative;
        }
        
        .message-date::before {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            top: 50%;
            height: 1px;
            background: rgba(255,255,255,0.1);
            z-index: 1;
        }
        
        .message-date span {
            background: #16213e;
            padding: 0 10px;
            position: relative;
            z-index: 2;
        }
        
        .message {
            max-width: 75%;
            display: flex;
            gap: 10px;
        }
        
        .message.incoming {
            align-self: flex-start;
        }
        
        .message.outgoing {
            align-self: flex-end;
            flex-direction: row-reverse;
        }
        
        .anonymous-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 16px;
            flex-shrink: 0;
            margin-top: auto;
        }
        
        .message-content {
            display: flex;
            flex-direction: column;
            gap: 5px;
            max-width: 100%;
        }
        
        .message-bubble {
            padding: 12px 15px;
            border-radius: 18px;
            position: relative;
            word-wrap: break-word;
            line-height: 1.4;
            font-size: 14px;
        }
        
        .message.incoming .message-bubble {
            background: rgba(255,255,255,0.1);
            border-top-left-radius: 5px;
            border: 1px solid rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
        }
        
        .message.outgoing .message-bubble {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-top-right-radius: 5px;
            border: 1px solid rgba(102, 126, 234, 0.3);
        }
        
        .message-time {
            font-size: 11px;
            color: rgba(255,255,255,0.5);
            align-self: flex-end;
        }
        
        .message.outgoing .message-time {
            color: rgba(255,255,255,0.7);
        }
        
        .sender-label {
            font-size: 10px;
            color: rgba(255,255,255,0.6);
            margin-bottom: 2px;
            font-weight: 500;
            letter-spacing: 0.5px;
        }
        
        /* –ü–∞–Ω–µ–ª—å –≤–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è */
        .input-container {
            background: rgba(26, 26, 46, 0.95);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
            position: sticky;
            bottom: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }
        
        .input-actions {
            display: flex;
            gap: 10px;
        }
        
        .input-action {
            background: rgba(255,255,255,0.1);
            border: none;
            font-size: 20px;
            color: white;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }
        
        .input-action:hover {
            background: rgba(255,255,255,0.2);
        }
        
        .message-input {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 25px;
            font-size: 14px;
            transition: border-color 0.3s;
            resize: none;
            max-height: 120px;
            min-height: 20px;
            line-height: 1.4;
            background: rgba(255,255,255,0.05);
            color: white;
        }
        
        .message-input:focus {
            outline: none;
            border-color: #667eea;
            background: rgba(255,255,255,0.08);
        }
        
        .message-input::placeholder {
            color: rgba(255,255,255,0.5);
        }
        
        .send-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }
        
        .send-button:hover {
            transform: scale(1.05);
        }
        
        .send-button:disabled {
            background: rgba(255,255,255,0.1);
            cursor: not-allowed;
            transform: none;
        }
        
        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç–∏ */
        .settings-panel {
            background: rgba(26, 26, 46, 0.95);
            border-radius: 15px;
            margin: 15px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            display: none;
        }
        
        .settings-panel.active {
            display: block;
        }
        
        .settings-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: white;
        }
        
        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .setting-label {
            font-size: 14px;
            color: rgba(255,255,255,0.9);
        }
        
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 26px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.2);
            transition: .4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 4px;
            bottom: 4px;
            background: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background: #667eea;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }
        
        .identity-selector {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .identity-option {
            flex: 1;
            padding: 10px;
            text-align: center;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .identity-option:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .identity-option.active {
            background: rgba(102, 126, 234, 0.2);
            border-color: #667eea;
        }
        
        .identity-icon {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .identity-name {
            font-size: 12px;
            color: rgba(255,255,255,0.9);
        }
        
        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏ */
        .typing-indicator {
            display: none;
            align-items: center;
            gap: 8px;
            padding: 10px 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 18px;
            width: fit-content;
            margin-bottom: 10px;
            align-self: flex-start;
            backdrop-filter: blur(10px);
        }
        
        .typing-indicator.active {
            display: flex;
        }
        
        .typing-dots {
            display: flex;
            gap: 3px;
        }
        
        .typing-dot {
            width: 6px;
            height: 6px;
            background: rgba(255,255,255,0.7);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }
        
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-5px);
            }
        }
        
        /* –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å */
        .encryption-status {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: rgba(26, 26, 46, 0.9);
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            z-index: 90;
        }
        
        .lock-icon {
            color: #4cd964;
            font-size: 14px;
        }
        
        /* –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è */
        .bottom-nav {
            background: rgba(26, 26, 46, 0.95);
            padding: 15px 20px;
            display: flex;
            justify-content: space-around;
            border-top: 1px solid rgba(255,255,255,0.1);
            position: sticky;
            bottom: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }
        
        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: rgba(255,255,255,0.6);
            transition: color 0.2s;
            flex: 1;
            max-width: 80px;
        }
        
        .nav-item.active {
            color: #667eea;
        }
        
        .nav-icon {
            font-size: 20px;
            margin-bottom: 5px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }
        
        .nav-item.active .nav-icon {
            background: rgba(102, 126, 234, 0.2);
        }
        
        .nav-label {
            font-size: 11px;
            font-weight: 500;
        }
        
        @media (max-width: 480px) {
            .chat-header {
                padding: 12px 15px;
            }
            
            .messages-container {
                padding: 15px;
            }
            
            .input-container {
                padding: 12px 15px;
            }
            
            .message {
                max-width: 85%;
            }
            
            .warning-banner {
                margin: 10px;
                padding: 12px;
            }
        }
    </style>
</head>
<body>
    <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å -->
    <div class="chat-header">
        <button class="back-button" onclick="window.location.href='friends-list.html'">‚Üê</button>
        
        <div class="chat-info">
            <div class="chat-title">–ê–Ω–æ–Ω–∏–º–Ω—ã–π —á–∞—Ç</div>
            <div class="chat-subtitle">–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ ‚Ä¢ –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ</div>
        </div>
        
        <div class="header-actions">
            <div class="header-action" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç–∏" onclick="toggleSettings()">‚öôÔ∏è</div>
            <div class="anonymous-badge">üë§ –ê–ù–û–ù</div>
        </div>
    </div>
    
    <!-- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ -->
    <div class="warning-banner">
        <div class="warning-icon">‚ö†Ô∏è</div>
        <div class="warning-text">
            –í—ã –æ–±—â–∞–µ—Ç–µ—Å—å –∞–Ω–æ–Ω–∏–º–Ω–æ. –í–∞—à–∞ –ª–∏—á–Ω–æ—Å—Ç—å —Å–∫—Ä—ã—Ç–∞. –°–æ–æ–±—â–µ–Ω–∏—è –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∏–ª–∏ –ø–µ—Ä–µ—Å–ª–∞–Ω—ã.
        </div>
    </div>
    
    <!-- –ü–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <div class="settings-panel" id="settingsPanel">
        <div class="settings-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç–∏</div>
        
        <div class="setting-item">
            <div class="setting-label">–°–ª—É—á–∞–π–Ω—ã–π –∞–≤–∞—Ç–∞—Ä</div>
            <label class="toggle-switch">
                <input type="checkbox" id="randomAvatar" checked>
                <span class="toggle-slider"></span>
            </label>
        </div>
        
        <div class="setting-item">
            <div class="setting-label">–ò–º—è –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è</div>
            <label class="toggle-switch">
                <input type="checkbox" id="showSender" checked>
                <span class="toggle-slider"></span>
            </label>
        </div>
        
        <div class="setting-item">
            <div class="setting-label">–°–∞–º–æ—É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ</div>
            <label class="toggle-switch">
                <input type="checkbox" id="selfDestruct">
                <span class="toggle-slider"></span>
            </label>
        </div>
        
        <div class="setting-item">
            <div class="setting-label">–í—ã–±–µ—Ä–∏—Ç–µ –ª–∏—á–Ω–æ—Å—Ç—å</div>
        </div>
        
        <div class="identity-selector" id="identitySelector">
            <div class="identity-option active" data-avatar="üë§" data-name="–ê–Ω–æ–Ω–∏–º 1">
                <div class="identity-icon">üë§</div>
                <div class="identity-name">–ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π</div>
            </div>
            <div class="identity-option" data-avatar="üé≠" data-name="–ê–Ω–æ–Ω–∏–º 2">
                <div class="identity-icon">üé≠</div>
                <div class="identity-name">–ú–∞—Å–∫–∞</div>
            </div>
            <div class="identity-option" data-avatar="üïµÔ∏è" data-name="–ê–Ω–æ–Ω–∏–º 3">
                <div class="identity-icon">üïµÔ∏è</div>
                <div class="identity-name">–î–µ—Ç–µ–∫—Ç–∏–≤</div>
            </div>
            <div class="identity-option" data-avatar="üëª" data-name="–ê–Ω–æ–Ω–∏–º 4">
                <div class="identity-icon">üëª</div>
                <div class="identity-name">–ü—Ä–∏–∑—Ä–∞–∫</div>
            </div>
        </div>
    </div>
    
    <!-- –û–±–ª–∞—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π -->
    <div class="messages-container" id="messagesContainer">
        <div class="message-date">
            <span>–°–µ–≥–æ–¥–Ω—è 20:00</span>
        </div>
        
        <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
        
        <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏ -->
        <div class="typing-indicator" id="typingIndicator">
            <div class="typing-dots">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            </div>
            <span style="font-size: 12px; color: rgba(255,255,255,0.7);">–∫—Ç–æ-—Ç–æ –ø–µ—á–∞—Ç–∞–µ—Ç...</span>
        </div>
    </div>
    
    <!-- –°—Ç–∞—Ç—É—Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è -->
    <div class="encryption-status">
        <span class="lock-icon">üîí</span>
        <span>–°–æ–æ–±—â–µ–Ω–∏—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã</span>
    </div>
    
    <!-- –ü–∞–Ω–µ–ª—å –≤–≤–æ–¥–∞ -->
    <div class="input-container">
        <div class="input-actions">
            <button class="input-action" onclick="sendRandomMessage()">üé≤</button>
            <button class="input-action" onclick="sendAnonymousQuestion()">‚ùì</button>
        </div>
        
        <textarea 
            class="message-input" 
            id="messageInput" 
            placeholder="–í–≤–µ–¥–∏—Ç–µ –∞–Ω–æ–Ω–∏–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." 
            rows="1"
            oninput="autoResize(this)"
            onkeypress="handleKeyPress(event)"
        ></textarea>
        
        <button class="send-button" id="sendButton" onclick="sendMessage()">‚û§</button>
    </div>
    
    <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="bottom-nav">
        <a href="main-hub.html" class="nav-item">
            <div class="nav-icon">üè†</div>
            <div class="nav-label">–ì–ª–∞–≤–Ω–∞—è</div>
        </a>
        
        <a href="vastapae-feed.html" class="nav-item">
            <div class="nav-icon">üì±</div>
            <div class="nav-label">VASTAPAE</div>
        </a>
        
        <a href="friends-list.html" class="nav-item">
            <div class="nav-icon">üë•</div>
            <div class="nav-label">FRIEND</div>
        </a>
        
        <a href="chat-anonymous.html" class="nav-item active">
            <div class="nav-icon">üé≠</div>
            <div class="nav-label">–ê–ù–û–ù</div>
        </a>
        
        <a href="family-main.html" class="nav-item">
            <div class="nav-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
            <div class="nav-label">FAMILY</div>
        </a>
    </nav>
    
    <script>
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç–∏
        let anonymousSettings = {
            currentIdentity: { avatar: 'üë§', name: '–ê–Ω–æ–Ω–∏–º 1' },
            randomAvatar: true,
            showSender: true,
            selfDestruct: false
        };
        
        // –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
        let messages = [
            { id: 1, text: "–ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ –∞–Ω–æ–Ω–∏–º–Ω—ã–π —á–∞—Ç.", sender: "incoming", time: "20:01", avatar: "üëª", name: "–ù–µ–∑–Ω–∞–∫–æ–º–µ—Ü" },
            { id: 2, text: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å –∑–¥–µ—Å—å?", sender: "user", time: "20:02", avatar: "üë§", name: "–ê–Ω–æ–Ω–∏–º 1" },
            { id: 3, text: "–í–∞—à–∞ –ª–∏—á–Ω–æ—Å—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫—Ä—ã—Ç–∞. –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –∞–≤–∞—Ç–∞—Ä—ã –∏ –∏–º–µ–Ω–∞.", sender: "incoming", time: "20:03", avatar: "üïµÔ∏è", name: "–î–µ—Ç–µ–∫—Ç–∏–≤" },
            { id: 4, text: "–ö—Ä—É—Ç–æ! –ê —Å–æ–æ–±—â–µ–Ω–∏—è —à–∏—Ñ—Ä—É—é—Ç—Å—è?", sender: "user", time: "20:04", avatar: "üë§", name: "–ê–Ω–æ–Ω–∏–º 1" },
            { id: 5, text: "–î–∞, –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã –∏ —É–¥–∞–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —á–∞—Ç–∞.", sender: "incoming", time: "20:05", avatar: "üé≠", name: "–ú–∞—Å–∫–∞" }
        ];
        
        document.addEventListener('DOMContentLoaded', function() {
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
            renderMessages();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—ã–±–æ—Ä–∞ –ª–∏—á–Ω–æ—Å—Ç–∏
            setupIdentitySelector();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π
            setupToggleSwitches();
            
            // –ê–≤—Ç–æ—Å–∫—Ä–æ–ª–ª –≤–Ω–∏–∑
            const container = document.getElementById('messagesContainer');
            container.scrollTop = container.scrollHeight;
            
            // –°–ª—É—á–∞–π–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ "–ø–µ—á–∞—Ç–∞–µ—Ç..." –¥–ª—è –¥–µ–º–æ
            setInterval(() => {
                if (Math.random() > 0.7) {
                    showTypingIndicator();
                    setTimeout(hideTypingIndicator, 2000 + Math.random() * 3000);
                }
            }, 8000);
            
            // –°–ª—É—á–∞–π–Ω—ã–µ –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –¥–µ–º–æ
            setInterval(() => {
                if (Math.random() > 0.8 && messages.length < 15) {
                    sendRandomIncomingMessage();
                }
            }, 15000);
        });
        
        function renderMessages() {
            const container = document.getElementById('messagesContainer');
            
            // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ (–¥–∞—Ç–∞) –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –ø–µ—á–∞—Ç–∏
            const childrenToRemove = [];
            for (let i = 0; i < container.children.length; i++) {
                const child = container.children[i];
                if (!child.classList.contains('message-date') && !child.id === 'typingIndicator') {
                    childrenToRemove.push(child);
                }
            }
            childrenToRemove.forEach(child => child.remove());
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è
            messages.forEach(msg => {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${msg.sender}`;
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä –∏ –∏–º—è –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
                let avatar = msg.avatar;
                let name = msg.name;
                
                if (msg.sender === 'user') {
                    avatar = anonymousSettings.currentIdentity.avatar;
                    name = anonymousSettings.currentIdentity.name;
                }
                
                messageDiv.innerHTML = `
                    <div class="anonymous-avatar">${avatar}</div>
                    <div class="message-content">
                        ${anonymousSettings.showSender && msg.sender === 'incoming' ? 
                          `<div class="sender-label">${name}</div>` : ''}
                        <div class="message-bubble">${msg.text}</div>
                        <div class="message-time">${msg.time}</div>
                    </div>
                `;
                
                // –í—Å—Ç–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–¥ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º –ø–µ—á–∞—Ç–∏
                const typingIndicator = document.getElementById('typingIndicator');
                container.insertBefore(messageDiv, typingIndicator);
            });
            
            // –ê–≤—Ç–æ—Å–∫—Ä–æ–ª–ª –≤–Ω–∏–∑
            container.scrollTop = container.scrollHeight;
        }
        
        function setupIdentitySelector() {
            const options = document.querySelectorAll('.identity-option');
            options.forEach(option => {
                option.addEventListener('click', function() {
                    // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö
                    options.forEach(opt => opt.classList.remove('active'));
                    // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Ç–µ–∫—É—â–µ–º—É
                    this.classList.add('active');
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                    anonymousSettings.currentIdentity = {
                        avatar: this.dataset.avatar,
                        name: this.dataset.name
                    };
                    
                    // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    renderMessages();
                });
            });
        }
        
        function setupToggleSwitches() {
            document.getElementById('randomAvatar').addEventListener('change', function() {
                anonymousSettings.randomAvatar = this.checked;
            });
            
            document.getElementById('showSender').addEventListener('change', function() {
                anonymousSettings.showSender = this.checked;
                renderMessages();
            });
            
            document.getElementById('selfDestruct').addEventListener('change', function() {
                anonymousSettings.selfDestruct = this.checked;
                if (this.checked) {
                    alert('–°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç —Å–∞–º–æ—É–Ω–∏—á—Ç–æ–∂–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞');
                }
            });
        }
        
        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            panel.classList.toggle('active');
        }
        
        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏
            if (textarea.value.length > 0) {
                showTypingIndicator();
            } else {
                hideTypingIndicator();
            }
        }
        
        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }
        
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const messageText = input.value.trim();
            
            if (messageText) {
                // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                const now = new Date();
                const time = now.getHours().toString().padStart(2, '0') + ':' + 
                            now.getMinutes().toString().padStart(2, '0');
                
                const newMessage = {
                    id: messages.length + 1,
                    text: messageText,
                    sender: 'user',
                    time: time,
                    avatar: anonymousSettings.currentIdentity.avatar,
                    name: anonymousSettings.currentIdentity.name
                };
                
                messages.push(newMessage);
                renderMessages();
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
                input.value = '';
                input.style.height = 'auto';
                
                // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏
                hideTypingIndicator();
                
                // –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ (—á–µ—Ä–µ–∑ 1-3 —Å–µ–∫—É–Ω–¥—ã)
                setTimeout(() => {
                    const replies = [
                        "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ...",
                        "–†–∞—Å—Å–∫–∞–∂–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ?",
                        "–°–æ–≥–ª–∞—Å–µ–Ω!",
                        "–•–º–º, –Ω–µ –¥—É–º–∞–ª –æ–± —ç—Ç–æ–º",
                        "–ê–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å - —ç—Ç–æ —Å–∏–ª–∞!",
                        "üîí",
                        "–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ",
                        "–ü—Ä–æ–¥–æ–ª–∂–∞–π..."
                    ];
                    
                    const randomReply = replies[Math.floor(Math.random() * replies.length)];
                    const randomAvatar = ['üëª', 'üïµÔ∏è', 'üé≠', 'üë§'][Math.floor(Math.random() * 4)];
                    const randomName = ['–ù–µ–∑–Ω–∞–∫–æ–º–µ—Ü', '–ê–Ω–æ–Ω–∏–º', '–ì–æ—Å—Ç—å', '–ü–æ—Å–µ—Ç–∏—Ç–µ–ª—å'][Math.floor(Math.random() * 4)];
                    
                    const replyTime = new Date();
                    const replyTimeStr = replyTime.getHours().toString().padStart(2, '0') + ':' + 
                                      replyTime.getMinutes().toString().padStart(2, '0');
                    
                    const replyMessage = {
                        id: messages.length + 1,
                        text: randomReply,
                        sender: 'incoming',
                        time: replyTimeStr,
                        avatar: randomAvatar,
                        name: randomName
                    };
                    
                    messages.push(replyMessage);
                    renderMessages();
                }, 1000 + Math.random() * 2000);
            }
        }
        
        function sendRandomMessage() {
            const randomMessages = [
                "–ß—Ç–æ –¥—É–º–∞–µ—à—å –æ–± –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç–∏ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ?",
                "–°–µ–≥–æ–¥–Ω—è –æ—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ –æ–±—â–µ–Ω–∏—è!",
                "–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ - –Ω–∞—à–µ –≤—Å–µ!",
                "–ö–∞–∫–æ–π —Ç–≤–æ–π –ª—é–±–∏–º—ã–π —Å–ø–æ—Å–æ–± –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –∞–Ω–æ–Ω–∏–º–Ω—ã–º?",
                "üîê",
                "–ê–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å –¥–∞–µ—Ç —Å–≤–æ–±–æ–¥—É —Å–ª–æ–≤–∞",
                "–¢—É—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ, –º–æ–∂–Ω–æ –≥–æ–≤–æ—Ä–∏—Ç—å –ø—Ä–∞–≤–¥—É",
                "–ö—Ç–æ –∑–¥–µ—Å—å? üòÑ"
            ];
            
            const input = document.getElementById('messageInput');
            input.value = randomMessages[Math.floor(Math.random() * randomMessages.length)];
            autoResize(input);
            input.focus();
        }
        
        function sendAnonymousQuestion() {
            const questions = [
                "–ö–∞–∫–æ–π —Å–∞–º—ã–π –∞–Ω–æ–Ω–∏–º–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä?",
                "–ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å –≤ —Å–µ—Ç–∏?",
                "–ß—Ç–æ —Ç–∞–∫–æ–µ VPN –∏ –∫–∞–∫ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç?",
                "–ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ?",
                "–¢–æ—Ä vs –æ–±—ã—á–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä - –≤ —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞?"
            ];
            
            const input = document.getElementById('messageInput');
            input.value = questions[Math.floor(Math.random() * questions.length)];
            autoResize(input);
            input.focus();
        }
        
        function sendRandomIncomingMessage() {
            const incomingMessages = [
                "–ö—Ç–æ-–Ω–∏–±—É–¥—å –∑–¥–µ—Å—å?",
                "–ü—Ä–∏–≤–µ—Ç –≤—Å–µ–º –∞–Ω–æ–Ω–∏–º–∞–º!",
                "–ö–∞–∫ –≤–∞—à–∏ –¥–µ–ª–∞?",
                "–õ—é–±–ª—é —ç—Ç—É –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å!",
                "–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–∞!",
                "–ú–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å?",
                "–ö–∞–∫–∞—è —Å–µ–≥–æ–¥–Ω—è —Ç–µ–º–∞ –¥–ª—è –æ–±—â–µ–Ω–∏—è?",
                "üîí –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞—â–∏—â–µ–Ω—ã"
            ];
            
            const randomAvatar = ['üëª', 'üïµÔ∏è', 'üé≠', 'üë§'][Math.floor(Math.random() * 4)];
            const randomName = ['–ù–µ–∑–Ω–∞–∫–æ–º–µ—Ü', '–ê–Ω–æ–Ω–∏–º', '–ì–æ—Å—Ç—å', '–ü–æ—Å–µ—Ç–∏—Ç–µ–ª—å'][Math.floor(Math.random() * 4)];
            
            const now = new Date();
            const time = now.getHours().toString().padStart(2, '0') + ':' + 
                        now.getMinutes().toString().padStart(2, '0');
            
            const newMessage = {
                id: messages.length + 1,
                text: incomingMessages[Math.floor(Math.random() * incomingMessages.length)],
                sender: 'incoming',
                time: time,
                avatar: randomAvatar,
                name: randomName
            };
            
            messages.push(newMessage);
            renderMessages();
        }
        
        function showTypingIndicator() {
            document.getElementById('typingIndicator').classList.add('active');
            const container = document.getElementById('messagesContainer');
            container.scrollTop = container.scrollHeight;
        }
        
        function hideTypingIndicator() {
            document.getElementById('typingIndicator').classList.remove('active');
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–∞–Ω–µ–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–µ
        document.addEventListener('click', function(event) {
            const settingsPanel = document.getElementById('settingsPanel');
            const settingsButton = document.querySelector('.header-action');
            
            if (!settingsPanel.contains(event.target) && 
                !settingsButton.contains(event.target) && 
                settingsPanel.classList.contains('active')) {
                settingsPanel.classList.remove('active');
            }
        });
    </script>
</body>
</html>